View(area_income_formatted)
# Stacked bar plot for expenses
plot <- ggplot() +
geom_area(
data = area_income_formatted,
aes(x = name, y = ExpenseValue, fill = ExpenseType),
alpha = 0.5,
position = "stack"
) +
geom_bar(data = bars_expenses_formatted,
aes(x = name, y = ExpenseValue, fill = ExpenseType),
stat = "identity",
position = "stack") +
labs(
title = "Average player income distribution among game choices",
x = "Welfare classes",
fill = "Category"
) +
# Custom fill colors
scale_fill_manual(values = c(
"Ave_Spendable" = "#E1BB70",
"Income" = "#e0cca4",
"ave_LivingCost" = "#cccccc",
"ave_debt" = "#9B9A9A",
"ave_satisfaction" = "#dfaba3",
"ave_measures" = "#9dd6db"
)) +
#Y-axis formatting
scale_y_continuous(
labels = function(x) x / 1000,
name = "Game Currency (k)"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5))
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(area_income)
View(area_income)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(area_income)
View(bars_expenses)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(bars_expenses)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(bars_expenses)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(bars_expenses)
View(bars_expenses_formatted)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(bars_expenses_formatted)
bars_expenses <- income_dist_plt %>% select(ave_LivingCost, ave_debt, ave_satisfaction, ave_measures)
View(area_income_formatted)
View(bars_expenses)
View(area_income_formatted)
View(area_income)
View(bars_expenses)
View(area_income_formatted)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(area_income_formatted)
View(bars_expenses_formatted)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(area_income)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(area_income)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
install.packages("ggpattern")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(bars_expenses_formatted)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(bars_expenses)
View(bars_expenses)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(area_income_formatted)
plot <- ggplot() +
geom_area(data = area_income_formatted,
aes(x = Index, y = Value, fill = Type, pattern = Type),
fill = "round_income", alpha = 0.6
) +
geom_bar_pattern(data = bars_expenses_formatted,
aes(x = Index, y = Value, fill = Type, pattern = Type),
stat = "identity",
position = "stack",
pattern_density = 0.5,
pattern_spacing = 0.02,
pattern_angle = 45,
pattern_size = 0.1
) +
geom_line(
data = line_spendable,
aes(x = Index,
y = ave_Spendable,
color = "ave_Spendable"),
size = 1.2) +
geom_line(
data = line_available,
aes(x = Index,
y = round_income,
color = "round_income"),
size = 1.2) +
labs(
title = "Average player income distribution among game choices",
x = "Welfare classes",
color = "Category"
) +
# Custom fill colors to what is plotted in the legend
scale_color_manual(
name = "Category",
values = c(
"ave_Spendable" = "black",
)) +
scale_fill_manual(
name = "Category",
values = c(
"round_income" = "#E1BB70",
"ave_LivingCost" = "#cccccc",
"ave_debt" = "#9B9A9A",
"ave_satisfaction" = "#dfaba3",
"ave_measures" = "#79A2C5",
"ave_mortgage" = "white",
"ave_taxes" = "white",
"ave_fluvial_damage" = "#79A2C5",
"ave_pluvial_damage" = "#79BCC5"
)) +
scale_pattern_manual(
values = c(
"ave_LivingCost" = "none",
"ave_debt" = "none",
"ave_satisfaction" = "none",
"ave_measures" = "stripe",
"ave_mortgage" = "stripe",
"ave_taxes" = "crosshatch",
"ave_fluvial_damage" = "none",
"ave_pluvial_damage" = "none"
)
)+
#Y-axis formatting
scale_y_continuous(
labels = function(x) x / 1000,
name = "Game Currency (k)"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5))
plot <- ggplot() +
geom_area(data = area_income_formatted,
aes(x = Index, y = Value, fill = Type, pattern = Type),
fill = "round_income", alpha = 0.6
) +
geom_bar_pattern(data = bars_expenses_formatted,
aes(x = Index, y = Value, fill = Type, pattern = Type),
stat = "identity",
position = "stack",
pattern_density = 0.5,
pattern_spacing = 0.02,
pattern_angle = 45,
pattern_size = 0.1
) +
geom_line(
data = line_spendable,
aes(x = Index,
y = ave_Spendable,
color = "ave_Spendable"),
size = 1.2) +
geom_line(
data = line_available,
aes(x = Index,
y = round_income,
color = "round_income"),
size = 1.2) +
labs(
title = "Average player income distribution among game choices",
x = "Welfare classes",
color = "Category"
) +
# Custom fill colors to what is plotted in the legend
scale_color_manual(
name = "Category",
values = c(
"ave_Spendable" = "black",
)) +
scale_fill_manual(
name = "Category",
values = c(
"round_income" = "#E1BB70",
"ave_LivingCost" = "#cccccc",
"ave_debt" = "#9B9A9A",
"ave_satisfaction" = "#dfaba3",
"ave_measures" = "#79A2C5",
"ave_mortgage" = "white",
"ave_taxes" = "white",
"ave_fluvial_damage" = "#79A2C5",
"ave_pluvial_damage" = "#79BCC5"
)) +
scale_pattern_manual(
values = c(
"ave_LivingCost" = "none",
"ave_debt" = "none",
"ave_satisfaction" = "none",
"ave_measures" = "stripe",
"ave_mortgage" = "stripe",
"ave_taxes" = "crosshatch",
"ave_fluvial_damage" = "none",
"ave_pluvial_damage" = "none"
)
)+
#Y-axis formatting
scale_y_continuous(
labels = function(x) x / 1000,
name = "Game Currency (k)"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5))
View(line_available)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
plot <- ggplot() +
geom_area(data = area_income_formatted,
aes(x = Index, y = Value, fill = Type, pattern = Type),
fill = "round_income", alpha = 0.6
) +
geom_bar_pattern(data = bars_expenses_formatted,
aes(x = Index, y = Value, fill = Type, pattern = Type),
stat = "identity",
position = "stack",
pattern_density = 0.5,
pattern_spacing = 0.02,
pattern_angle = 45,
pattern_size = 0.1
) +
geom_line(
data = line_spendable,
aes(x = Index,
y = ave_Spendable,
color = "ave_Spendable"),
size = 1.2) +
labs(
title = "Average player income distribution among game choices",
x = "Welfare classes",
color = "Category"
) +
# Custom fill colors to what is plotted in the legend
scale_color_manual(
name = "Category",
values = c(
"ave_Spendable" = "black"
)) +
scale_fill_manual(
name = "Category",
values = c(
"round_income" = "#E1BB70",
"ave_LivingCost" = "#cccccc",
"ave_debt" = "#9B9A9A",
"ave_satisfaction" = "#dfaba3",
"ave_measures" = "#79A2C5",
"ave_mortgage" = "white",
"ave_taxes" = "white",
"ave_fluvial_damage" = "#79A2C5",
"ave_pluvial_damage" = "#79BCC5"
)) +
scale_pattern_manual(
values = c(
"round_income" = "none",
"ave_LivingCost" = "none",
"ave_debt" = "none",
"ave_satisfaction" = "none",
"ave_measures" = "stripe",
"ave_mortgage" = "stripe",
"ave_taxes" = "crosshatch",
"ave_fluvial_damage" = "none",
"ave_pluvial_damage" = "none"
)
)+
#Y-axis formatting
scale_y_continuous(
labels = function(x) x / 1000,
name = "Game Currency (k)"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5))
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
plot <- ggplot() +
geom_area(data = area_income_formatted,
aes(x = Index, y = Value, fill = Category),
fill = Type, alpha = 0.6
) +
geom_bar(data = bars_expenses_formatted,
aes(x = Index, y = Value, fill = Category),
stat = "identity",
position = "stack"
) +
geom_line(
data = line_spendable,
aes(x = Index,
y = ave_Spendable,
color = "ave_Spendable"),
size = 1.2) +
labs(
title = "Average player income distribution among game choices",
x = "Welfare classes",
color = "Category"
) +
# Custom fill colors to what is plotted in the legend
scale_color_manual(
name = "Category",
values = c(
"ave_Spendable" = "black"
)) +
scale_fill_manual(
name = "Category",
values = c(
"round_income" = "#E1BB70",
"ave_LivingCost" = "#a3a3a3",
"ave_debt" = "black",
"ave_satisfaction" = "#dfaba3",
"ave_measures" = "white",
"ave_mortgage" = "#cccccc",
"ave_taxes" = "#dddddd",
"ave_fluvial_damage" = "#79A2C5",
"ave_pluvial_damage" = "#79BCC5"
)) +
scale_pattern_manual(
values = c(
"round_income" = "none",
"ave_LivingCost" = "none",
"ave_debt" = "none",
"ave_satisfaction" = "none",
"ave_measures" = "stripe",
"ave_mortgage" = "none",
"ave_taxes" = "none",
"ave_fluvial_damage" = "none",
"ave_pluvial_damage" = "none"
)
)+
#Y-axis formatting
scale_y_continuous(
labels = function(x) x / 1000,
name = "Game Currency (k)"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5))
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
View(area_income_formatted)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
plot <- ggplot() +
geom_area(data = area_income_formatted,
aes(x = Index, y = Value, fill = Type),
alpha = 0.6
) +
geom_bar(data = bars_expenses_formatted,
aes(x = Index, y = Value, fill = Type),
stat = "identity",
position = "stack"
) +
geom_line(
data = line_spendable,
aes(x = Index,
y = ave_Spendable,
color = "ave_Spendable"),
size = 1.2) +
labs(
title = "Average player income distribution among game choices",
color = "Category"
) +
# Custom fill colors to what is plotted in the legend
scale_color_manual(
name = "Category",
values = c(
"ave_Spendable" = "black"
)) +
scale_fill_manual(
name = "Category",
values = c(
"round_income" = "#E1BB70",
"ave_LivingCost" = "#a3a3a3",
"ave_debt" = "black",
"ave_satisfaction" = "#dfaba3",
"ave_measures" = "white",
"ave_mortgage" = "#cccccc",
"ave_taxes" = "#dddddd",
"ave_fluvial_damage" = "#79A2C5",
"ave_pluvial_damage" = "#79BCC5"
)) +
scale_pattern_manual(
values = c(
"round_income" = "none",
"ave_LivingCost" = "none",
"ave_debt" = "none",
"ave_satisfaction" = "none",
"ave_measures" = "stripe",
"ave_mortgage" = "none",
"ave_taxes" = "none",
"ave_fluvial_damage" = "none",
"ave_pluvial_damage" = "none"
)
)+
#Y-axis formatting
scale_y_continuous(
labels = function(y) y / 1000,
name = "Game Currency (k)"
) +
scale_x_continuous(
name = "Welfare Classes",
breaks = c(1, 2, 3, 4, 5, 6),
labels = c("Very Low", "Low", "Low-average", "High-average", "High", "Very High")
)
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
plot <- ggplot() +
geom_area(data = area_income_formatted,
aes(x = Index, y = Value, fill = Type),
alpha = 0.6
) +
geom_bar(data = bars_expenses_formatted,
aes(x = Index, y = Value, fill = Type),
stat = "identity",
position = "stack"
) +
geom_line(
data = line_spendable,
aes(x = Index,
y = ave_Spendable,
color = "ave_Spendable"),
size = 1.2) +
labs(
title = "Average player income distribution among game choices",
color = "Category"
) +
# Custom fill colors to what is plotted in the legend
scale_color_manual(
name = "Category",
values = c(
"ave_Spendable" = "black"
)) +
scale_fill_manual(
name = "Category",
values = c(
"round_income" = "#E1BB70",
"ave_LivingCost" = "#a3a3a3",
"ave_debt" = "black",
"ave_satisfaction" = "#dfaba3",
"ave_measures" = "white",
"ave_mortgage" = "#cccccc",
"ave_taxes" = "#dddddd",
"ave_fluvial_damage" = "#79A2C5",
"ave_pluvial_damage" = "#79BCC5"
)) +
scale_pattern_manual(
values = c(
"round_income" = "none",
"ave_LivingCost" = "none",
"ave_debt" = "none",
"ave_satisfaction" = "none",
"ave_measures" = "stripe",
"ave_mortgage" = "none",
"ave_taxes" = "none",
"ave_fluvial_damage" = "none",
"ave_pluvial_damage" = "none"
)
)+
#Y-axis formatting
scale_y_continuous(
labels = function(y) y / 1000,
name = "Game Currency (k)"
) +
scale_x_continuous(
name = "Welfare Classes",
breaks = c(1, 2, 3, 4, 5, 6),
labels = c("Very Low", "Low", "Low-average", "High-average", "High", "Very High")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 0, hjust = 0.5)
plot.title = element_text(hjust = 0.5),
source("~/TUDelft/18_Notebooks/R data analysis/250813_Ommen session_240924.R")
library(shiny); runApp('250813_Ommen session_240924.R')
